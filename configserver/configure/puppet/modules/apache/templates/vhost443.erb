NameVirtualHost *:443
<VirtualHost *:443>

  SSLEngine On
  SSLCertificateFile <%= cert_file %>
  SSLCertificateKeyFile <%= pk_file %>
  RequestHeader set X_FORWARDED_PROTO 'https'

  ErrorLog /etc/httpd/logs/ssl_error_log
  TransferLog /etc/httpd/logs/ssl_access_log
  LogLevel <%= scope.lookupvar("apache::variables::httpd_log_level") %>

  ProxyRequests off

  Alias /examples "/usr/share/aeolus-configserver/examples"
  <Directory "/usr/share/aeolus-configserver/examples">
    Options +Indexes
  </Directory>

  # for directory listing in examples dir
  Alias /icons/ "/var/www/icons/"

  ProxyPass /examples !
  ProxyPass /icons/ !
  ProxyPass /<%= scope.lookupvar("apache::variables::config_server_context") %> <%= scope.lookupvar("apache::variables::config_server_url") %>
  ProxyPassReverse /<%= scope.lookupvar("apache::variables::config_server_context") %> <%= scope.lookupvar("apache::variables::config_server_url") %>
  ProxyPassReverse /icons/ !
  ProxyPassReverse /examples !

  Include conf.d/cs443/*.conf

</VirtualHost>
